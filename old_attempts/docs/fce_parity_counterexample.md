# Контрпример паритета к формулировке FCE-леммы

## Постановка задачи

Рассмотрим семейство булевых функций $F = \{p, \bar p\}$ на $n$ битах, где $p(x) = x_1 \oplus x_2 \oplus \dots \oplus x_n$ — паритет, а $\bar p = 1 \oplus p$.

* Размер семейства $|F| = 2$, следовательно, коллизионная энтропия $H_2(F) = \log_2 |F| = 1$.
* В формулировке FCE-леммы из проекта требуется существование семейства подкубов $\mathcal{R}$, каждый из которых монохромен одновременно для всех функций в $F$, и такое, что для каждой функции $f \in F$ объединение подкубов из $\mathcal{R}$, на которых $f \equiv 1$, покрывает все её единичные входы, причём $|\mathcal{R}| \le n(h+2)2^{10h}$ при $h = H_2(F)$.【F:fce_lemma_proof.md†L31-L85】

## Наблюдение о монохромности

Любой нетривиальный подкуб $R \subseteq \{0,1\}^n$ содержит по крайней мере две точки, отличающиеся флипом свободной координаты. Паритет меняет значение при любом флипе, поэтому $p$ не может быть константен на $R$. Тем самым подкуб, монохромный одновременно для $p$ и $\bar p$, обязан иметь нулевую размерность, то есть быть отдельной точкой.

## Необходимое число подкубов

Функция $p$ принимает значение $1$ на ровно $2^{n-1}$ точках. Поскольку каждый допустимый подкуб вырождается в точку, для покрытия всех единичных входов $p$ требуется как минимум $2^{n-1}$ таких «подкубов-точек». Следовательно, любое семейство $\mathcal{R}$, удовлетворяющее требованиям FCE-леммы, должно содержать не менее $2^{n-1}$ элементов.

## Противоречие с заявленным верхним пределом

Оценка, заявленная в FCE-лемме, утверждает, что $|\mathcal{R}| \le n(h+2)2^{10h}$. При $h = 1$ она превращается в $|\mathcal{R}| \le 3n \cdot 2^{10}$, то есть в верхнюю границу порядка $O(n)$, которая для больших $n$ существенно меньше $2^{n-1}$. Значит, текущая формулировка FCE-леммы не может быть верной: семейство паритета и его отрицания даёт строгий контрпример.

## Выводы для общей стратегии доказательства

* Путь доказательства $P \ne NP$, изложенный в документе по FCE-лемме, критически опирается на существование малого покрытия общими монохромными подкубами.【F:fce_lemma_proof.md†L9-L90】
* Контрпример показывает, что заявленная граница $2^{o(n)}$ (и даже любая субэкспоненциальная граница) недостижима в текущей постановке задачи.
* Следовательно, либо условия леммы должны быть ослаблены (например, разрешены разные покрытия для разных функций или должны использоваться более общие объекты, чем подкубы), либо стратегию нужно радикально пересмотреть.

Таким образом, без переработки формулировки FCE-леммы продвинуться к доказательству $P \ne NP$ описанным способом невозможно: требуемый комбинаторный шаг ложен уже на элементарном семействе функций.

## Что делать дальше

### 1. Явно признать сбой в остальных документах

* В черновике доказательства FCE-леммы необходимо зафиксировать предупреждение о том, что «теорема» противоречит контрпримеру из этого файла, и что любые ссылки на субэкспоненциальное покрытие опираются на ложную гипотезу.【F:fce_lemma_proof.md†L1-L40】
* План «Master Blueprint» также обязан отражать тот факт, что комбинаторное ядро не просто незаполнено, а ошибочно, иначе downstream-работы будут строиться на несостоятельном основании.【F:docs/master_blueprint.md†L1-L33】

### 2. Пересмотреть требование о едином покрытии

Главная причина провала — жёсткое требование, чтобы один и тот же набор подкубов подходил для всех функций семейства. Для паритета и его отрицания это заведомо невозможно. Возможные варианты смягчения:

1. **Разрешить индивидуальные покрытия.** Для каждого $f \in F$ строить собственное семейство подкубов $\mathcal{R}_f$ с общей длиной описания \(\sum_f |\mathcal{R}_f|\) ограниченной субэкспоненциальной функцией. Это устраняет текущий контрпример, но придётся перепроверить, достаточно ли такого варианта для связки с последующими аргументами об `MCSP` и `P \nsubseteq \mathrm{P/poly}`.
2. **Переопределить «монохромность» для семейства.** Вместо совпадения значений всех функций можно требовать лишь совпадения «большинства» или ограниченного числа исключений. Тогда подкубы положительной размерности перестанут автоматически отбрасываться паритетом, однако придётся переписывать шаги, которые использовали строгую монохромность для объединения.
3. **Заменить подкубы на более общие объекты.** Например, на цилиндры/решётки, где каждая функция фиксирует собственный набор координат. В этом случае объединяющая структура сможет выдержать семейство \(\{p, \bar p\}\), но понадобится новая комбинаторика.

### 3. Проверить зависимые результаты

1. **Леммы о «sunflower» и «entropy drop».** Нужно удостовериться, что они не предполагают заранее существование общего подкуба; возможно, их можно сохранить без изменений, но связку с завершающим шагом — нет.
2. **Код и формальные доказательства.** Любые Lean-модули, утверждающие границу `≤ 2^{3n + 11h + 2}`, теперь противоречат действительности. Их следует пометить как аксиомы или отключить до тех пор, пока не появится корректная формулировка.

### 4. Переоценка глобальной стратегии

Учитывая, что «Master Blueprint» опирается на FCE-лемму как на завершённый этап, важно пересмотреть общую программу:

* Определить, существует ли альтернативная комбинаторная лемма, совместимая с текущими downstream-планами.
* Если альтернативы нет, переключить усилия на независимые направления (магнификация, низкие чувствительности и т.д.), чтобы не блокироваться из-за ложного шага.

### 5. Документация и коммуникация

* Обновить сводные отчёты (roadmap, status-страницы), чтобы каждый участник проекта видел текущее состояние и не делал выводов из опровергнутых утверждений.
* Вынести ключевые риски: FCE-лемма в заявленном виде недостижима; все дальнейшие аргументы, завязанные на неё, требуют рефакторинга.

Следующий рабочий шаг — синхронизировать документацию и репозиторий с данной оценкой, затем выбрать направление для реструктуризации доказательства.

## Связанные контрпримеры

Паритет — лишь самый яркий представитель более широкой семьи обструкций.  В [каталоге контрпримеров](fce_counterexample_catalog.md)
собраны другие классы семейств, где совместное покрытие монохромными подкубами также требует экспоненциального числа точек: функции с
полностью изолированными единицами, конфликтующие пары и случайные семейства.  Перед любой попыткой исправить формулировку FCE-леммы
следует убедиться, что новая версия устойчиво проходит эти тесты.
